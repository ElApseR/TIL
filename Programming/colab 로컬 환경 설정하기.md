# 로컬에 colaboratory 환경 설정하기

colaboratory(이하 colab)는 구글에서 제공하는 클라우드 기반의 무료 jupyter 노트북 환경입니다. 사용법에 관한 간단한 사항들은 <a href="https://colab.research.google.com/notebooks/welcome.ipynb#scrollTo=nGXrezT31pvC">여기</a>를 클릭하시면 확인할 수 있습니다. 기본적으로 주피터 노트북을 사용하던 분들은 쉽게 적응하실 수 있습니다. 제가 생각하는 colab의 장점은 다음과 같습니다.

1. 클라우드에서 돌아가기 때문에 실행이 오래 걸리는 코드(최대 2시간)를 돌려놓고 컴퓨터를 꺼도 된다.
2. 로컬 리소스가 부족한 경우에 좋은 대안이 될 수 있다. 특히 gpu를 무료로 쓸 수 있다.
3. 구글 드라이브와 연동되므로, 용량이 큰 파일을 로컬에 저장하기 싫을 때 활용 가능하다.

하지만 분명한 단점도 존재합니다. 가장 큰 단점은 아무리 사용해도 불편하긴 하다는 점입니다. 평소에 주피터 노트북 단축키에 굉장히 익숙한데, colab에서는 단축키가 다르기도 하며, 해당 기능이 아예 존재하지 않는 경우도 있습니다. 단축키를 사용자화 하더라도 불편함은 남을 수밖에 없는 것이지요.
따라서 저는 (조금 많이)귀찮긴 하지만 코딩은 로컬 주피터로 하고, 실행만 구글 colab을 활용하기로 하였습니다. 다음은 제가 수행한 방법입니다.

1. 구글 클라우드 폴더를 로컬로 동기화 한다.
2. terminal에서 해당 위치로 이동하여 jupyter notebook을 실행한다.
3. 마음껏 코딩을 한 뒤, colab에서 실행한다.

사실 이렇기만 하면 귀찮음이 없는데, 로컬에서 코딩하는 과정에서 코드를 실행할 때 문제가 발생합니다. 구글 드라이브를 colab에 마운트 했을 때 파일의 상대경로와 로컬에서의 상대경로가 다른 것입니다. 따라서 어느 환경에서 실행해도 상대경로가 동일하도록 아래 코드를 항상 실행해줍니다.

> ~~~python
> try:
>     from google.colab import drive
>     drive.mount('/content/drive/')
>     default_dir = '/content/drive/My Drive/Colab Notebooks/'
> except:
>     default_dir = '/Users/HyunhoCho/Google 드라이브/Colab Notebooks/'
> ~~~

만일 로컬 환경에서 수행할 경우, try 구문에서 오류가 나고 except 구문이 바로 실행되므로, 모든 상대 경로를 default_dir을 기준으로 짜면 로컬과 colab 환경에서 동일하게 코딩을 할 수 있습니다. 또한, 개인적으로 만든 module을 활용해야 하는 경우가 있는데 이 때는 아래 코드를 실행합니다.

> ~~~python
> import sys
> sys.path.append(default_dir+'modules/')
> ~~~

위 코드를 실행하면 modules 폴더 안에 들어있는 모든 모듈을 동일하게 import 할 수 있습니다.

사실 정말 많이 귀찮은 과정이지만, 저는 상황상 gpu가 필요한 코드를 여러 개, 오랜 시간 돌려야하기 때문에 이 방법을 사용하고 있습니다. 그래도 무료로 클라우드 환경을 쓸 수 있으니 버틸만 합니다. 돈이 넉넉하다면 유료 클라우드 계정을 활용하고 싶네요... 사실 개인 서버가 있으면 더할나위 없겠습니다. 이상 colab 삽질 과정을 간단하게 공유하였습니다. 
